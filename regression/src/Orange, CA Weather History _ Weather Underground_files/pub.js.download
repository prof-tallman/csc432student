/* GptMeasurement HouseHold ImplementationValidator LegacyLayer SignalsAutoInsertion SignalsBsc SignalsIds SignalsTvp SignalsVlp WeatherConfig */
(()=>{var le=Object.defineProperty,vr=Object.defineProperties,br=Object.getOwnPropertyDescriptor,Cr=Object.getOwnPropertyDescriptors;var qe=Object.getOwnPropertySymbols;var Ir=Object.prototype.hasOwnProperty,wr=Object.prototype.propertyIsEnumerable;var de=(n,t,e)=>t in n?le(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,ct=(n,t)=>{for(var e in t||(t={}))Ir.call(t,e)&&de(n,e,t[e]);if(qe)for(var e of qe(t))wr.call(t,e)&&de(n,e,t[e]);return n},Mt=(n,t)=>vr(n,Cr(t)),o=(n,t)=>le(n,"name",{value:t,configurable:!0});var s=(n,t,e,r)=>{for(var i=r>1?void 0:r?br(t,e):t,d=n.length-1,u;d>=0;d--)(u=n[d])&&(i=(r?u(t,e,i):u(i))||i);return r&&i&&le(t,e,i),i};var a=(n,t,e)=>de(n,typeof t!="symbol"?t+"":t,e);var S=(n,t,e)=>new Promise((r,i)=>{var d=h=>{try{m(e.next(h))}catch(f){i(f)}},u=h=>{try{m(e.throw(h))}catch(f){i(f)}},m=h=>h.done?r(h.value):Promise.resolve(h.value).then(d,u);m((e=e.apply(n,t)).next())});var l={"7646":{adServerId:1358,customTracking:{c2:{type:"targeting",key:"ver"}},adPositionKey:"pos"}};var ce={queueAdRequest:o(n=>{var t;try{(t=n.callback)==null||t.call(n),n.callback=null}catch(e){}},"queueAdRequest"),defineSlot:o((n,t)=>{},"defineSlot"),adRendered:o((n,t)=>{},"adRendered"),adRemoved:o(n=>{},"adRemoved"),getTargeting:o(n=>({}),"getTargeting"),addEventListener:o((n,t)=>{},"addEventListener"),removeEventListener:o((n,t)=>{},"removeEventListener"),toggleDebugMode:o(()=>{console.log("%c[UT-DEBUG]%c Debug mode is not available for this tag.","color: red","color: intial")},"toggleDebugMode"),_debugScriptLoaded:o(()=>{},"_debugScriptLoaded"),onSlotVisibleForTime:o((n,t,e)=>{},"onSlotVisibleForTime")};var ue=class ue{constructor(){a(this,"isEntryModule",!0)}};o(ue,"EntryModule");var x=ue;var zt=class zt{constructor(t){a(this,"_error");a(this,"_message","unknown");a(this,"_trace",[]);if(t instanceof zt)return t;t instanceof Error&&(this._error=t,this._message=t.message)}get error(){return this._error}get message(){return this._message}get trace(){return this._trace}addToTrace(t){this.trace.unshift(t)}};o(zt,"TracedError");var vt=zt;var ge=class ge{constructor(t,e){a(this,"window");a(this,"dvtag");a(this,"modules",new Map);a(this,"errorHandlers",[]);a(this,"errors",[]);var r;this.window=e,this.window.dvtag=(r=this.window.dvtag)!=null?r:{},this.dvtag=this.window.dvtag,this.dvtag._core=this;for(let[i,d]of Object.entries(ce))this.dvtag[i]=d;for(let i of t)this.createModule(i);for(let i of this.modules.values())this.applyModuleDecoration(i);for(let i of this.modules.values())this.applyErrorDecoration(i);for(let i of this.modules.values())this.applyPluginDecoration(i);for(let i of this.modules.values())this.applyApiDecoration(i);for(let i of this.modules.values())this.applyExecuteDecoration(i)}get moduleList(){return[...this.modules.keys()].map(t=>t.name)}get entryModuleList(){return[...this.modules.entries()].filter(([t,e])=>e instanceof x).map(([t,e])=>t.name)}get(t){return this.getModule(t).gateway}getByName(t){let e=[...this.modules.keys()].find(r=>r.name===t);return e!=null?this.get(e):null}getModule(t){let e=this.modules.get(t);if(e==null)throw new Error(`module not in core: ${t.name}`);return e}createModule(t){if(t.prototype.moduleConfig==null)throw new Error(`not a module: ${t.name}`);let e=new t;e.core=this,e.gateway={module:e},this.modules.set(t,e)}applyModuleDecoration(t){var i,d,u,m,h,f;let e=t.constructor.prototype.moduleConfig,r=t.constructor.name;for(let{method:A}of e){let M=t[A].bind(t),q=(u=(d=(i=this.dvtag._hooks)==null?void 0:i.interceptModule)==null?void 0:d[r])==null?void 0:u[A],_=q==null?M:q.bind(t),B=(f=(h=(m=this.dvtag._hooks)==null?void 0:m.inspectModule)==null?void 0:h[r])==null?void 0:f[A],J=B==null?_:(...Z)=>{let lt=_(...Z);return B(Z,lt),lt},jt=o((...Z)=>{let lt;try{lt=J(...Z)}catch(yt){throw this.traceMethodError(t,A,Z,yt)}return lt instanceof Promise?lt.then(yt=>yt,yt=>{throw this.traceMethodError(t,A,Z,yt)}):lt},"traced");t.gateway[A]=jt}if(t.plugins!=null){t.pluginFunctions={};for(let A of Object.keys(t.plugins)){t.pluginFunctions[A]=[];let M=t.pluginFunctions[A];t.plugins[A]=(...q)=>{let _=[];for(let B of M)try{_.push(B(...q))}catch(J){this.tracePluginError(t,A,J)}return _}}}}traceMethodError(t,e,r,i){let d=new vt(i);return d.addToTrace(`${t.constructor.name}.${e}(${r.map(u=>typeof u).join(",")})`),d}traceExecuteError(t){let e=new vt(t);return e.addToTrace("@execute"),this.handleSevereError(e),e}tracePluginError(t,e,r){let i=new vt(r);return i.addToTrace(`@plugin(${t.constructor.name}, '${e}')`),this.handleSevereError(i),i}traceApiError(t,e){let r=new vt(e);return r.addToTrace(`@api('${t}')`),this.handleSevereError(r),r}handleSevereError(t){for(let e of this.errorHandlers)try{e(t)}catch(r){}this.errors.length>10||this.errors.push({message:t.message,trace:t.trace})}applyErrorDecoration(t){var r;let e=(r=t.constructor.prototype.errorConfig)!=null?r:[];for(let{method:i}of e)this.errorHandlers.push(t.gateway[i])}applyPluginDecoration(t){var r;let e=(r=t.constructor.prototype.pluginConfig)!=null?r:[];for(let{PluggableClass:i,category:d,method:u}of e)this.getModule(i).pluginFunctions[d].push(t.gateway[u])}applyApiDecoration(t){var r;let e=(r=t.constructor.prototype.apiConfig)!=null?r:[];for(let{api:i,method:d}of e)Object.defineProperty(this.dvtag,i,{value:o((...u)=>{var m,h;try{return t.gateway[d](...u)}catch(f){return this.traceApiError(i,f),(h=(m=ce)[i])==null?void 0:h.call(m,...u)}},"value"),writable:!1})}applyExecuteDecoration(t){return S(this,null,function*(){var r;let e=(r=t.constructor.prototype.executeConfig)!=null?r:[];for(let{method:i}of e)try{yield t.gateway[i]()}catch(d){this.traceExecuteError(d)}})}};o(ge,"Core");var kt=ge;var me=[],pe=me;var g=o(n=>{let t=n.prototype,e=Object.getOwnPropertyNames(t).filter(r=>{var i;return r!=="constructor"&&((i=Object.getOwnPropertyDescriptor(t,r))==null?void 0:i.value)instanceof Function});t.moduleConfig=e.map(r=>({method:r})),me.push(n)},"moduleClass"),N=o(n=>t=>{},"attachModule"),D=o((n,t)=>{var e;n.executeConfig=(e=n.executeConfig)!=null?e:[],n.executeConfig.push({method:t})},"executeMethod"),p=o((n,t)=>(e,r)=>{var i;e.pluginConfig=(i=e.pluginConfig)!=null?i:[],e.pluginConfig.push({PluggableClass:n,category:t,method:r})},"pluginMethod"),ut=o(n=>(t,e)=>{var r;t.apiConfig=(r=t.apiConfig)!=null?r:[],t.apiConfig.push({api:n,method:e})},"apiMethod"),Ne=o((n,t)=>{var e;n.errorConfig=(e=n.errorConfig)!=null?e:[],n.errorConfig.push({method:t})},"errorMethod");var Ut=o(n=>{if(n==null)return[];let t=Le(n);return t!=null?[t]:Array.isArray(n)?n.map(Le).filter(e=>e!=null):[]},"parseSlotSizes"),Le=o(n=>{if(n==null)return null;if(typeof n=="string")return{label:n};if(Array.isArray(n)){if(n.length===1&&typeof n[0]=="string")return{label:n[0]};if(n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number")return{width:n[0],height:n[1]}}if(typeof n=="object"){let{label:t,width:e,height:r}=n;if(typeof e=="number"&&typeof r=="number")return{width:e,height:r};if(typeof t=="string")return{label:t}}return null},"parseSlotSize");var Fe=o(n=>{try{return n.getSizes()}catch(t){return[]}},"getGptSlotSizesSafe");var Kt=o(n=>{let t=n.split("/").map(i=>i.trim()).filter(i=>i.length>0);if(t.length<2)return;let e=t[0].split(",",1)[0],r=Number(e);return Number.isNaN(r)?void 0:`${r}`},"getNetworkCodeFromAdUnit");var Yt=o((n,t)=>{let e=n.getAdUnitPath(),r=Kt(e);return{id:e,network:r,sizes:Ut(Fe(n)),position:n.getTargeting(t)[0]}},"gptSlotToAdUnit");var fe="dvp_spos";var L=class{_getAdServers(){try{return l}catch(t){return{}}}isAdServerConfigured(t){return t!=null&&t in this._getAdServers()}getAdServerConfig(t){var e;return t==null||!this.isAdServerConfigured(t)?{}:(e=this._getAdServers()[t])!=null?e:{}}getAdServerCustomTracking(t){var e;return t==null||!this.isAdServerConfigured(t)?{}:(e=this._getAdServers()[t].customTracking)!=null?e:{}}getAdServerId(t){if(!(t==null||!this.isAdServerConfigured(t)))return this._getAdServers()[t].adServerId}getAdPositionKey(t){var e,r;return t==null?fe:(r=(e=this._getAdServers()[t])==null?void 0:e.adPositionKey)!=null?r:fe}};o(L,"AdServers"),L=s([g],L);var U=[];for(let n=0;n<256;++n)U.push((n+256).toString(16).slice(1));function Me(n,t=0){return(U[n[t+0]]+U[n[t+1]]+U[n[t+2]]+U[n[t+3]]+"-"+U[n[t+4]]+U[n[t+5]]+"-"+U[n[t+6]]+U[n[t+7]]+"-"+U[n[t+8]]+U[n[t+9]]+"-"+U[n[t+10]]+U[n[t+11]]+U[n[t+12]]+U[n[t+13]]+U[n[t+14]]+U[n[t+15]]).toLowerCase()}o(Me,"unsafeStringify");var he,Dr=new Uint8Array(16);function Se(){if(!he){if(typeof crypto=="undefined"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");he=crypto.getRandomValues.bind(crypto)}return he(Dr)}o(Se,"rng");var Pr=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Te={randomUUID:Pr};function Or(n,t,e){var i,d,u;if(Te.randomUUID&&!t&&!n)return Te.randomUUID();n=n||{};let r=(u=(d=n.random)!=null?d:(i=n.rng)==null?void 0:i.call(n))!=null?u:Se();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){if(e=e||0,e<0||e+16>t.length)throw new RangeError(`UUID byte range ${e}:${e+15} is out of buffer bounds`);for(let m=0;m<16;++m)t[e+m]=r[m];return t}return Me(r)}o(Or,"v4");var Ae=Or;var ht=o(()=>Ae(),"uuid");var Re=class Re{constructor(t,e,r,i=ht(),d=Date.now()){this.source=t;this.elementId=e;this.adUnit=r;this.uuid=i;this.creationTime=d;a(this,"_variables",new Map)}setVariable(t,e){this._variables.set(t,e)}getVariable(t){return this._variables.get(t)}hasVariable(t){return this._variables.has(t)}clearVariable(t){this._variables.delete(t)}};o(Re,"Slot");var Bt=Re;var T=class{constructor(){a(this,"plugins",{slotDiscovered:o((t,e)=>[],"slotDiscovered"),slotDestroyed:o(t=>[],"slotDestroyed")});a(this,"_slots",{})}getSlot(t,e){var r;return(r=this._slots[t])==null?void 0:r[e]}getSlots(t){var e;if(t==null){let r=[];for(let i of Object.values(this._slots))r.push(...Object.values(i));return r}return Object.values((e=this._slots[t])!=null?e:{})}createSlot(t,e,r,i,d){var h,f;let u=this.getSlot(t,r);u!=null&&this.plugins.slotDestroyed(u);let m=new Bt(t,r,i);return(f=(h=this._slots)[t])!=null||(h[t]={}),this._slots[t][r]=m,d==null||d(m),this.plugins.slotDiscovered(m,e),m}};o(T,"SlotStore"),T=s([g],T);var Ee=class Ee{set(t,e){t.setVariable(this,e)}get(t){return t.getVariable(this)}getOrDefault(t,e){return t.hasVariable(this)?this.get(t):(this.set(t,e),e)}getOrDefaultFromFunction(t,e){if(t.hasVariable(this))return this.get(t);let r=e();return this.set(t,r),r}delete(t){t.clearVariable(this)}};o(Ee,"SlotVariable");var I=Ee;var bt=o((...n)=>{let t=[];for(let e of n)if(e!=null)for(let r of e)t.includes(r)||t.push(r);return t},"mergeUnique");var R=class{constructor(){a(this,"plugins",{getAdServerTargeting:o((t,e)=>[],"getAdServerTargeting"),setAdServerTargeting:o((t,e,r)=>[],"setAdServerTargeting")});a(this,"globalTargeting",{});a(this,"slotTargeting",new I)}_getSlotTargeting(t){var r;let e=(r=this.slotTargeting.get(t))!=null?r:{};return this.slotTargeting.set(t,e),e}_getTargetingKeys(t){return bt(Object.keys(this.globalTargeting),Object.keys(this._getSlotTargeting(t)))}_getTargetingValues(t,e){return bt(this.globalTargeting[e],this._getSlotTargeting(t)[e])}getTargeting(t){let e={};if(t==null)for(let r of Object.keys(this.globalTargeting))e[r]=[...this.globalTargeting[r]];else for(let r of this._getTargetingKeys(t))e[r]=this._getTargetingValues(t,r);return e}setSlotTargeting(t,e,r=!1){var u;let i=Object.keys(e),d=this._getSlotTargeting(t);for(let m of i)d[m]=bt(e[m],r?(u=this.slotTargeting.get(t))==null?void 0:u[m]:null);this.setAdServerTargeting(t,i)}setGlobalTargeting(t,e=!1){let r=Object.keys(t);for(let i of r)this.globalTargeting[i]=bt(t[i],e?this.globalTargeting[i]:null);for(let i of this.core.get(T).getSlots())this.setAdServerTargeting(i,r)}getAdServerTargeting(t,e){var r;return(r=this.plugins.getAdServerTargeting(t,e).find(i=>i.length!==0))!=null?r:[]}setAdServerTargeting(t,e){e==null&&(e=this._getTargetingKeys(t));for(let r of e)this.plugins.setAdServerTargeting(t,r,this._getTargetingValues(t,r))}_onSlotDiscovered(t){this.setAdServerTargeting(t)}};o(R,"TargetingHub"),s([p(T,"slotDiscovered")],R.prototype,"_onSlotDiscovered",1),R=s([g],R);var Ur=[[/((\?)|&)(?:amp_lite|fr=operanews)/g,"$2"],[/(^https?:\/\/)(www\.)/g,"$1"],[/(((\?)|&|%3F|%26|;)(?:utm_campaign|utm_source|utm_content|utm_term|utm_viral|utm_medium|utm_identifier|utm_key|fb_source|referrer|referer|ref|rand|rnd|randid|\.?rand|\.?partner|cb|count|adid|session|sessionid|session_redirect|param\d|userinfo|uid|refresh|ocid|ncid|clickenc|fbclid|amp_js_v|amp_gsa|ns_source|ns_campaign|ns_mchanel|ns_mchannel|ns_linkname|ns_fee|src|ex_cid|usqp|source|xid|trkid|utm_social-type|mbid|utm_brand|__twitter_impression|utm_referrer|CMP|cmp|_cmp|cq_cmp)=[^&]*)/g,"$3"],[/[/.]amp(?:\/[?&]*)?$/g,""],[/((\?)|&)(?:outputType|isFollow|suppressMediaBar|cid|ICID|icid|bdk|wtu_id_h|utm_placement|intcmp|_native_ads|traffic_source|entry|\.tsrc|autoplay|autostart|dc_data|influencer|pubdate|utm_hp_ref|redirect|service|refresh_ce|refresh_cens|xcmg|target_id|_amp)=[^&]*/g,"$2"],[/(\?|&)(?:amp)(?:&|$|=[^&]*)/g,"$1"]],qr=[[/(?:\/|\/\?|\?|&|\/\$0|#[\s\S]*)+$/g,""],[/(?:\/|\/\?|\?|&|\/\$0|#[\s\S]*)+$/g,""]],ke=o((n,t)=>{for(let[e,r]of n)t=t.replace(e,r);return t},"replaceByRules"),Be=o(n=>{let t=ke(Ur,n);return ke(qr,t)},"normalizeUrl");var Qe=o(n=>n.split("?",1)[0].split("#",1)[0],"stripUrlQuery");var Ve=o((n,t)=>{try{let e=new URLSearchParams(n),r=e.get("ctx"),i=e.get("cmp");if(r!=null&&i!=null)return{ctx:r,cmp:i,prefetch:t,legacy:!0}}catch(e){}return null},"parseInfo"),Ge=o(n=>{var t;return n.pathname!=="/signals/pub.js"?null:(t=Ve(n.search,!0))!=null?t:Ve(n.hash.substring(1),!1)},"parseLegacyPagetagUrl");var Nr=1e3,Lr=/^\/dvtag\/([^/]+)\/([^/]+)\/pub\.js$/,b=class{constructor(){a(this,"visit");a(this,"tagInfo");a(this,"plugins",{newVisit:o(t=>[],"newVisit")});a(this,"_normalizeUrl",Be)}_initialize(){this.getTagInfo(),this.updateVisit(!1),this.plugins.newVisit(this.visit),this._installNavigationListener()}getTagInfo(){var t;if(this.tagInfo==null){try{this.tagInfo=this._parseTagInfo()}catch(e){}(t=this.tagInfo)!=null||(this.tagInfo={ctx:"unknown",cmp:"unknown"})}return this.tagInfo}_parseTagInfo(){let t=this.getCurrentScriptSrc();if(t==null)return null;let e=new URL(t,"https://pub.doubleverify.com"),r=e.pathname,i=Lr.exec(r);if(i!=null){let[,d,u]=i;return{ctx:d,cmp:u}}return Ge(e)}getCurrentScriptSrc(){var t,e;return(e=(t=this.core.window.document.currentScript)==null?void 0:t.getAttribute("src"))!=null?e:null}updateVisit(t=!0){var r,i;let e=this.getStrippedPageUrl();if(this.visit==null||this.visit.strippedUrl!==e){let d=ht();this.visit={strippedUrl:e,normalizedUrl:this._normalizeUrl(this.core.window.location.href),uuid:d,sessionUuid:(i=(r=this.visit)==null?void 0:r.sessionUuid)!=null?i:d},t&&this.plugins.newVisit(this.visit)}return this.visit}getVisit(){var t;return(t=this.visit)!=null?t:this.updateVisit(!1)}getStrippedPageUrl(){return Qe(this.core.window.location.href)}getNormalizedPageUrl(){return this.getVisit().normalizedUrl}getVisitUuid(){return this.getVisit().uuid}getSessionUuid(){return this.getVisit().sessionUuid}_installNavigationListener(){let{window:t}=this.core,e=o(()=>this.updateVisit(!0),"cb");t.navigation!=null?t.navigation.addEventListener("navigatesuccess",e):setInterval(e,Nr)}};o(b,"Context"),s([D],b.prototype,"_initialize",1),b=s([g],b);var _e=class _e{constructor(){a(this,"pending",[]);a(this,"flushing",!1)}push(t){this.pending.push(t),this.flush()}flush(){return S(this,null,function*(){var e;if(this.flushing)return;this.flushing=!0;let t=this.pending.shift();for(;t!=null;){try{yield t.promise}catch(r){}try{(e=t.callback)==null||e.call(t)}catch(r){}t=this.pending.shift()}this.flushing=!1})}};o(_e,"AsyncQueue");var $t=_e;var E=class{constructor(){a(this,"plugins",{adRequestQueued:o(t=>[],"adRequestQueued"),adRequestTimedOut:o(t=>[],"adRequestTimedOut"),adRequestBeforeRelease:o(t=>[],"adRequestBeforeRelease"),adRequestCompleted:o(t=>[],"adRequestCompleted")});a(this,"queue",new $t);a(this,"adRequestCounter",0)}_queueAdRequest(t={}){var d,u;let e={index:this.adRequestCounter++,status:"queued",timeoutValue:(d=t.timeout)!=null?d:0,onDvtagReadyCalled:(u=t.timestamp)!=null?u:0,waitingStarted:new Date().getTime(),internal:t.internal};this.core.get(b).updateVisit(),this.plugins.adRequestQueued(e);let r=t.callback;r===void 0?t.callback=()=>{}:r===null?e.status="tag-timeout":t.callback=()=>{e.status="queue-timeout",e.callbackCalled=new Date().getTime(),t.callback=null,this.plugins.adRequestTimedOut(e);try{r()}catch(m){}};let i=o(()=>{if(t.callback!=null){t.callback=null,e.status="success",e.callbackCalled=new Date().getTime(),this.plugins.adRequestBeforeRelease(e);try{r==null||r()}catch(m){}}else this.plugins.adRequestBeforeRelease(e);e.waitingEnded=new Date().getTime(),this.plugins.adRequestCompleted(e)},"onAsyncOperationsCompleted");this.queue.push({callback:i,adRequest:e})}delayAdRequests(t){this.queue.push({promise:t})}};o(E,"AdRequestQueue"),s([ut("queueAdRequest")],E.prototype,"_queueAdRequest",1),E=s([g],E);var Q=class{getShortCommitId(){return"349dd1b"}getBuildTimestamp(){return 1737831617251}getAuthToken(){return"CidNt+d84IU9TEoHVlLXY55IOFIMQRJzJl0G3arH8lkSp/AvPuiW5zWS32D2/raDI1MAqmnmDEN+dcbe/8/mixjHMXWxSrq6hBbgBrzMCgUTmMQ4CMmCSpqqNIEa7EzLUPfoSEIxbbr0VbodUyd1Orc="}};o(Q,"DefinedVariables"),Q=s([g],Q);var G=class{constructor(){a(this,"cache",{})}_performFetchJson(t,e){return S(this,null,function*(){let r=t;if(e!=null&&e.authToken){let u=this.core.get(Q).getAuthToken(),m=new URL(t);m.searchParams.set("token",u),r=m.href}let i=yield this.core.window.fetch(r);return{json:yield i.json(),headers:i.headers}})}fetchJson(t,e){return S(this,null,function*(){let r=this.cache[t];return r==null&&(r=this._performFetchJson(t,e).then(i=>i.json),this.cache[t]=r),r})}};o(G,"Fetch"),G=s([g],G);var Qt=["BSC","ABS","CCT","CBS"],ye=["IDS"],Vt=["VLP","TVP"],Mr=[...Qt,...ye,...Vt],zs=[...Qt,...ye,...Vt].filter(n=>n!=="CCT"),He=o(n=>Mr.includes(n.toUpperCase()),"isSignal"),je=o(n=>Vt.includes(n.toUpperCase()),"isSlotSignal"),ze=o(n=>ye.includes(n.toUpperCase()),"isUserSignal"),Ke=o(n=>Qt.includes(n.toUpperCase()),"isPageSignal");var Wt=o(n=>n==null?"":`@${n}`,"getPositionSuffix");var kr=/^(\d+)x(\d+)$/,Ye=o(n=>n==="all"?[]:n.split(",").map(t=>{let e=t.match(kr);return e==null?{label:t}:{width:parseInt(e[1],10),height:parseInt(e[2],10)}}),"stringToSlotSizes"),ve=o(n=>n.length===0?"all":n.map(({width:t,height:e,label:r})=>r!=null?r:`${t}x${e}`).join(","),"slotSizesToString"),$e=o(n=>n==null?"":n.length>0&&n.every(({label:r})=>r==null)?ve(n):"","slotSizesToStringIfSpecific");var Br="https://pub.doubleverify.com/dvtag/signals/",H=class{_getBaseUrl(t){let e=this.core.get(b),{ctx:r,cmp:i}=e.getTagInfo(),d=e.getNormalizedPageUrl();try{d=new URL(d).origin}catch(m){}let u=new URL(t,Br);return u.searchParams.set("ctx",r),u.searchParams.set("cmp",i),u.searchParams.set("url",d),u}getUserTargetingUrl(t){let e=this._getBaseUrl("ids/pub.json");return t.includes("IDS")&&e.searchParams.set("ids","1"),e.href}getPageTargetingUrl(t,e){let r=this._getBaseUrl("bsc/pub.json");return r.searchParams.set("url",e),t.includes("BSC")&&r.searchParams.set("bsc","1"),t.includes("ABS")&&r.searchParams.set("abs","1"),t.includes("CBS")&&r.searchParams.set("cbs","1"),t.includes("CCT")&&r.searchParams.set("cct","1"),r.href}getSlotTargetingUrl(t,e){var d;let r=this._getBaseUrl("vlp/pub.json");t.includes("VLP")&&r.searchParams.set("vlp","1"),t.includes("TVP")&&r.searchParams.set("tvp","1");let i=0;for(let u of e){let{id:m,position:h,sizes:f}=(d=u.adUnit)!=null?d:{},A=m+Wt(h);r.searchParams.set(`slot-${i++}-${A}`,$e(f))}return r.href}};o(H,"SignalsUrlBuilder"),H=s([g],H);var St=class{constructor(){a(this,"cache",{})}_fetchFreshSignals(t,e){return S(this,null,function*(){if(!e.some(Ke))return{};let r=this.core.get(H).getPageTargetingUrl(e,t),i;try{i=yield this.core.get(G).fetchJson(r,{authToken:!0})}catch(d){return{}}return i instanceof Object?i:{}})}fetchSignals(t,e=3){return S(this,null,function*(){let r=this.core.get(b),i=r.getNormalizedPageUrl(),d=r.getStrippedPageUrl();this.cache[d]==null&&(this.cache[d]=this._fetchFreshSignals(i,t));let u=yield this.cache[d];return this.core.get(b).getStrippedPageUrl()!==d&&e>0?this.fetchSignals(t,e-1):u})}};o(St,"PageSignals"),St=s([g],St);var Tt=class{constructor(){a(this,"cache",{});a(this,"pendingSlots",[]);a(this,"pendingBulkRequest",null)}_scheduleBulkRequest(t){return S(this,null,function*(){yield Promise.resolve();let e=this.core.get(H).getSlotTargetingUrl(t,this.pendingSlots);this.pendingSlots=[],this.pendingBulkRequest=null;let r;try{r=yield this.core.get(G).fetchJson(e,{authToken:!0})}catch(i){return[]}return r})}_fetchFreshSignals(t,e){return S(this,null,function*(){if(!e.some(je))return{};let r=this.pendingSlots.push(t)-1;this.pendingBulkRequest==null&&(this.pendingBulkRequest=this._scheduleBulkRequest(e));let d=(yield this.pendingBulkRequest)[r];return d instanceof Object?d:{}})}_getCacheKey(t){var m,h;let{id:e,position:r,sizes:i}=(m=t.adUnit)!=null?m:{},d=e+Wt(r),u=(h=i==null?void 0:i.map(f=>{var A;return(A=f.label)!=null?A:`${f.width}x${f.height}`}).sort().join(","))!=null?h:"";return`${d}#${u}`}fetchSignals(t,e){return S(this,null,function*(){let r=this._getCacheKey(t);return this.cache[r]==null&&(this.cache[r]=this._fetchFreshSignals(t,e)),this.cache[r]})}};o(Tt,"SlotSignals"),Tt=s([g],Tt);var At=class{constructor(){a(this,"cache")}_fetchFreshSignals(t){return S(this,null,function*(){if(!t.some(ze))return{};let e=this.core.get(H).getUserTargetingUrl(t),r;try{r=yield this.core.get(G).fetchJson(e,{authToken:!0})}catch(i){return{}}return r instanceof Object?r:{}})}fetchSignals(t){return S(this,null,function*(){return this.cache==null&&(this.cache=this._fetchFreshSignals(t)),this.cache})}};o(At,"UserSignals"),At=s([g],At);var y=class{constructor(){a(this,"plugins",{getEnabledSignals:o(()=>[],"getEnabledSignals"),userTargetingUpdated:o(t=>[],"userTargetingUpdated"),pageTargetingUpdated:o(t=>[],"pageTargetingUpdated"),slotTargetingUpdated:o((t,e)=>[],"slotTargetingUpdated")});a(this,"dataForMigrationTracking",{userTargeting:{},pageTargeting:{},slotTargeting:new Map})}getEnabledSignals(){return this.plugins.getEnabledSignals()}getDataForMigrationTracking(){return this.dataForMigrationTracking}_initialize(){this.getUserTargeting(),this.getPageTargeting()}_onAdRequestQueued(){this.getPageTargeting()}_onSlotDiscovered(t){this.getSlotTargeting(t)}getUserTargeting(){return S(this,null,function*(){let t=this._fetchUserTargeting();return this.core.get(E).delayAdRequests(t),t})}getPageTargeting(){return S(this,null,function*(){let t=this._fetchPageTargeting();return this.core.get(E).delayAdRequests(t),t})}getSlotTargeting(t){return S(this,null,function*(){let e=this._fetchSlotTargeting(t);return this.core.get(E).delayAdRequests(e),e})}_fetchUserTargeting(){return S(this,null,function*(){let t=yield this.core.get(At).fetchSignals(this.getEnabledSignals());return this.core.get(R).setGlobalTargeting(t),this.dataForMigrationTracking.userTargeting=t,this.plugins.userTargetingUpdated(t),t})}_fetchPageTargeting(){return S(this,null,function*(){let t=yield this.core.get(St).fetchSignals(this.getEnabledSignals());return this.core.get(R).setGlobalTargeting(t),this.dataForMigrationTracking.pageTargeting=t,this.plugins.pageTargetingUpdated(t),t})}_fetchSlotTargeting(t){return S(this,null,function*(){let e=yield this.core.get(Tt).fetchSignals(t,this.getEnabledSignals());return this.core.get(R).setSlotTargeting(t,e),this.dataForMigrationTracking.slotTargeting.set(t,e),this.plugins.slotTargetingUpdated(t,e),e})}};o(y,"Signals"),s([D],y.prototype,"_initialize",1),s([p(E,"adRequestQueued")],y.prototype,"_onAdRequestQueued",1),s([p(T,"slotDiscovered")],y.prototype,"_onSlotDiscovered",1),y=s([g],y);var j=class{constructor(){a(this,"pq",null)}getPq(){return this.pq==null&&(this.pq=this._initialize()),this.pq}getPts(){return this.getPq().PTS}setApi(t){let e=this.getPq();e!=null&&(e.init=()=>{},e.loadSignals=t.loadSignals,e.loadSignalsForSlots=t.loadSignalsForSlots,e.getTargeting=t.getTargeting)}_pushToDvtagCmd(...t){var e;this.core.dvtag.cmd=(e=this.core.dvtag.cmd)!=null?e:[],this.core.dvtag.cmd.push(...t)}_initialize(){var r,i;this.core.window.PQ=(r=this.core.window.PQ)!=null?r:{};let t=this.core.window.PQ;if(t.loaded)return{cmd:[],PTS:{}};t.loaded=!0,t.PTS=(i=t.PTS)!=null?i:{};let e=t.cmd;return t.cmd={push:o(d=>this._pushToDvtagCmd(d),"push")},Array.isArray(e)&&this._pushToDvtagCmd(...e),t}};o(j,"LegacyPq"),j=s([g],j);var We=o(n=>{var r,i,d;let t=ht(),e={id:(i=(r=n.adUnitPath)!=null?r:n.invCode)!=null?i:n.tagId,sizes:Ut(Ye((d=n.sizes)!=null?d:"all")),position:n.position};return{elementId:t,adUnit:e}},"parseLegacyAdUnit");var Xe=o((n,t)=>{var i;let e=(i=n.IDS)==null?void 0:i[0];if(e==null)return;let r=parseInt(e);isNaN(r)||(t.IDS=r)},"setUserTargetingOnPts"),Je=o((n,t)=>{for(let e of Qt)n[e]!=null&&(t[e]=n[e])},"setPageTargetingOnPts"),Ze=o((n,t,e)=>{var m,h,f,A,M,q;let{adUnit:r}=n;if((r==null?void 0:r.id)==null)return;let i=r.id,d=ve((m=r.sizes)!=null?m:[]),u=r.position;for(let _ of Vt){let B=t[_];B!=null&&((h=e[_])!=null||(e[_]={}),(A=(f=e[_])[i])!=null||(f[i]={}),e[_][i][d]=B[0],u!=null&&((q=(M=e[_][i])[u])!=null||(M[u]={}),e[_][i][u][d]=B[0]))}},"setSlotTargetingOnPts");var tt=class extends x{_initialize(){this.core.get(j).setApi({loadSignals:this.loadSignals.bind(this),loadSignalsForSlots:this.loadSignalsForSlots.bind(this),getTargeting:this.getTargeting.bind(this)})}_setUserTargetingOnPts(t){let e=this.core.get(j).getPts();Xe(t,e)}_setPageTargetingOnPts(t){let e=this.core.get(j).getPts();Je(t,e)}_setSlotTargetingOnPts(t,e){let r=this.core.get(j).getPts();Ze(t,e,r)}loadSignals(t,e){return S(this,null,function*(){yield this._onDvtagReady("loadSignals",e)})}loadSignalsForSlots(t,e,r){return S(this,null,function*(){let i=this.core.get(y),d=this.core.get(T);for(let m of t){let h=m.getSlotElementId(),f=d.getSlot("gpt",h);if(f==null){let A=this.core.get(L).getAdPositionKey(m.getAdUnitPath());f=d.createSlot("gpt",0,h,Yt(m,A))}i.getSlotTargeting(f)}let u=typeof e=="function"?e:r;yield this._onDvtagReady("loadSignalsForSlots",u)})}getTargeting(t,e){return S(this,null,function*(){var u;let r=this.core.get(y),i=this.core.get(T);for(let m of(u=t.adUnits)!=null?u:[]){let{elementId:h,adUnit:f}=We(m),A=i.createSlot("legacy-api",0,h,f);r.getSlotTargeting(A)}let d=o(()=>e==null?void 0:e(void 0,this.core.get(j).getPts()),"callback");yield this._onDvtagReady("getTargeting",d)})}_getPubAdsTargeting(t){var e,r,i;return(i=(r=(e=this.core.window.googletag)==null?void 0:e.pubads)==null?void 0:r.call(e).getTargeting(t))!=null?i:[]}_onDvtagReady(t,e){return S(this,null,function*(){yield new Promise(r=>{this.core.window.dvtag.queueAdRequest({callback:o(()=>{try{e==null||e()}catch(i){}r()},"callback"),timestamp:new Date().getTime(),timeout:750,internal:!0})})})}};o(tt,"LegacyLayer"),s([D],tt.prototype,"_initialize",1),s([p(y,"userTargetingUpdated")],tt.prototype,"_setUserTargetingOnPts",1),s([p(y,"pageTargetingUpdated")],tt.prototype,"_setPageTargetingOnPts",1),s([p(y,"slotTargetingUpdated")],tt.prototype,"_setSlotTargetingOnPts",1),tt=s([g],tt);var Ct=class extends x{_getEnabledSignals(){return"IDS"}};o(Ct,"SignalsIds"),s([p(y,"getEnabledSignals")],Ct.prototype,"_getEnabledSignals",1),Ct=s([g],Ct);var It=class extends x{_getEnabledSignals(){return"BSC"}};o(It,"SignalsBsc"),s([p(y,"getEnabledSignals")],It.prototype,"_getEnabledSignals",1),It=s([g],It);var wt=class extends x{_getEnabledSignals(){return"VLP"}};o(wt,"SignalsVlp"),s([p(y,"getEnabledSignals")],wt.prototype,"_getEnabledSignals",1),wt=s([g],wt);var xt=class extends x{_getEnabledSignals(){return"TVP"}};o(xt,"SignalsTvp"),s([p(y,"getEnabledSignals")],xt.prototype,"_getEnabledSignals",1),xt=s([g],xt);var C=class{getWindow(){return this.core.window}getDocument(){return this.getWindow().document}getUserAgent(){var t,e;return(e=(t=this.getWindow().navigator)==null?void 0:t.userAgent)!=null?e:""}getPageUrl(){var t,e;return(e=(t=this.getWindow().location)==null?void 0:t.href)!=null?e:""}getHostname(){return new URL(this.getPageUrl()).hostname}getNavigator(){return this.getWindow().navigator}getPerformance(){var t;return(t=this.getWindow().performance)!=null?t:{}}getPerformanceTimeMs(){var t,e,r;return Math.floor((r=(e=(t=this.getPerformance()).now)==null?void 0:e.call(t))!=null?r:null)}isInQuirksMode(){return this.getDocument().compatMode==="BackCompat"}getDOMParser(){let t=this.getWindow().DOMParser;return new t}};o(C,"Environment"),C=s([g],C);var tr=o((n,t=!0)=>{let e=document.createElement("script");return e.setAttribute("src",n),t&&e.setAttribute("async",""),e},"createScriptElement");var Jt=o((n,t)=>{n.appendChild(t)},"addElement");var Qr=o(n=>new Promise((e,r)=>{let i=Dt(n);i!=null&&i.readyState==="complete"&&e(),n.addEventListener("load",()=>{e()}),n.addEventListener("error",()=>{r(new Error("Failed to load iframe"))})}),"waitForIframeReady"),er=o((n,t)=>S(void 0,null,function*(){yield Qr(n);let e=Dt(n);if(e==null)throw new Error("Failed to set content to iframe");Jt(e.body,t)}),"setIframeContent"),Dt=o(n=>{try{return n&&(n.contentDocument||n.contentWindow&&n.contentWindow.document||frames&&frames[n.name]&&frames[n.name].document)}catch(t){return null}},"getIframeDocument");var Rt=o((n,t)=>{try{if(Dt(n)===null)return!0;if(n.src===""||n.src==="about:blank")return!1;let e=new URL(n.src),r=new URL(t.location.href);return e.origin!==r.origin}catch(e){return!0}},"isCrossOriginIframe");var Vr="google_ads_iframe_",rr=o(n=>{if(n==null)return null;let t=n.querySelectorAll(`iframe[id^="${Vr}"]`);return t.length===1?t[0]:null},"lookupGptIframe");var or=o((n,t)=>{var m;let e=n.document.getElementById(t);if(e==null)return{element:null};let r=rr(e);if(r==null)return{element:e};if(Rt(r,n))return{element:r};let d=Dt(r),u=(m=d==null?void 0:d.body)!=null?m:null;return u==null?{element:r}:{element:u,parentIframe:r}},"getGptAdContainer");var Et=class{constructor(){a(this,"_getGptAdContainer",or)}getAdContainer(t){let e=this.core.get(C).getWindow();return t.source==="gpt"?this._getGptAdContainer(e,t.elementId):{element:e.document.getElementById(t.elementId)}}};o(Et,"AdLocator"),Et=s([g],Et);var v=class{constructor(){a(this,"adEmpty",new I);a(this,"adRequestInFlight",new I);a(this,"nonEmptyAdResponses",new I);a(this,"plugins",{adRequested:o(t=>[],"adRequested"),adRequestedOrInferred:o(t=>[],"adRequestedOrInferred"),adRendered:o((t,e,r)=>[],"adRendered"),adRemoved:o(t=>[],"adRemoved")})}setAdRequested(t){this.adRequestInFlight.set(t,!0),this.plugins.adRequested(t),this.plugins.adRequestedOrInferred(t)}setAdRendered(t,e){this.adRequestInFlight.get(t)!==!0&&this.plugins.adRequestedOrInferred(t),this.setAdRemoved(t),this.adEmpty.set(t,!1),this.adRequestInFlight.set(t,!1),e!=null&&this.nonEmptyAdResponses.set(t,this.nonEmptyAdResponses.getOrDefault(t,0)+1);let r=this.core.get(Et).getAdContainer(t);this.plugins.adRendered(t,e,r)}setAdRemoved(t){this.adEmpty.get(t)===!1&&(this.adEmpty.set(t,!0),this.plugins.adRemoved(t))}getNonEmptyAdRenderedCount(t){return this.nonEmptyAdResponses.getOrDefault(t,0)}};o(v,"AdServerHub"),v=s([g],v);var z=class{getPubAds(){var e,r;let t=this.core.get(C).getWindow();try{return(r=(e=t.googletag)==null?void 0:e.pubads)==null?void 0:r.call(e)}catch(i){return}}onPubAdsReady(t){var i,d,u,m;let e=this.core.get(C).getWindow();e.googletag=(i=e.googletag)!=null?i:{},e.googletag.cmd=(d=e.googletag.cmd)!=null?d:[];let r=this.getPubAds();if(r!=null)t(r);else try{(m=(u=e.googletag.cmd)==null?void 0:u.push)==null||m.call(u,()=>{r=this.getPubAds(),r!=null&&t(r)})}catch(h){}}};o(z,"GoogletagPubAds"),z=s([g],z);var w=class{constructor(){a(this,"gptReference",new I);a(this,"plugins",{slotDiscovered:o((t,e)=>[],"slotDiscovered"),slotDestroyed:o(t=>[],"slotDestroyed")})}_scanForSlots(){this.core.get(z).onPubAdsReady(t=>{t.getSlots().map(e=>this.maybeDiscoverSlot(e,0))})}getGptSlot(t){return this.gptReference.get(t)}maybeDiscoverSlot(t,e){let r=this.core.get(T).getSlot("gpt",t.getSlotElementId());return r==null||this.gptReference.get(r)!==t?this._createSlot(t,e):r}_createSlot(t,e){let r=t.getSlotElementId(),i=t.getAdUnitPath(),d=Kt(i),u=this.core.get(L).getAdPositionKey(d),m=Yt(t,u);return this.core.get(T).createSlot("gpt",e,r,m,f=>this.gptReference.set(f,t))}_onSlotDiscovered(t,e){t.source==="gpt"&&this.plugins.slotDiscovered(t,e)}_onSlotDestroyed(t){t.source==="gpt"&&this.plugins.slotDestroyed(t)}};o(w,"GoogletagSlots"),s([D,p(E,"adRequestQueued")],w.prototype,"_scanForSlots",1),s([p(T,"slotDiscovered")],w.prototype,"_onSlotDiscovered",1),s([p(T,"slotDestroyed")],w.prototype,"_onSlotDestroyed",1),w=s([g],w);var et=class{constructor(){a(this,"plugins",{adRemoved:o(t=>[],"adRemoved")})}_monitorAdRemoval(t){if(t.source!=="gpt")return;let e=this.core.get(C).getDocument().getElementById(t.elementId);if(e==null)return;new MutationObserver(i=>{let d=i.length,u=[...i].reverse(),m=0,h=e.children.length;for(let f of u){if(h===0){this.plugins.adRemoved(t);break}if(m===d-1)break;let A=f.removedNodes.length-f.addedNodes.length;h+=A,m++}}).observe(e,{childList:!0})}_onSlotDestroyed(t){this.plugins.adRemoved(t)}};o(et,"GoogletagAdRemoved"),s([p(w,"slotDiscovered")],et.prototype,"_monitorAdRemoval",1),s([p(w,"slotDestroyed")],et.prototype,"_onSlotDestroyed",1),et=s([g],et);var Zt=o(n=>{if(typeof n=="string"||Array.isArray(n)&&n.length===2&&n.every(t=>typeof t=="number"))return n},"cleanSizeInput");var V=o(n=>{if(typeof n=="string")return n;if(typeof n=="number")return`${n}`},"cleanStringInput");var rt=class{constructor(){a(this,"plugins",{adRequested:o(t=>[],"adRequested"),adRendered:o((t,e)=>[],"adRendered")})}_getHtmlSafe(t){var e,r;try{return(r=(e=t.getHtml)==null?void 0:e.call(t))!=null?r:void 0}catch(i){return}}_initialize(){this.core.get(z).onPubAdsReady(t=>{t.addEventListener("slotRequested",e=>{let r=this.core.get(w).maybeDiscoverSlot(e.slot,1);this.plugins.adRequested(r)}),t.addEventListener("slotRenderEnded",e=>{let r=this.core.get(w).maybeDiscoverSlot(e.slot,2);if(e.isEmpty){this.plugins.adRendered(r,null);return}let i={advertiserId:V(e.advertiserId),campaignId:V(e.campaignId),creativeId:V(e.creativeId),lineItemId:V(e.lineItemId),renderedSize:Zt(e.size),html:this._getHtmlSafe(e.slot)};this.plugins.adRendered(r,i)})})}};o(rt,"GoogletagEvents"),s([D],rt.prototype,"_initialize",1),rt=s([g],rt);var gt=class{getAdServerTargeting(t,e){var u,m;let r=this.core.get(w).getGptSlot(t);if(r==null)return[];let i=[];try{i=this._cleanTargeting((m=(u=this.core.get(z).getPubAds())==null?void 0:u.getTargeting)==null?void 0:m.call(u,e))}catch(h){}let d=[];try{d=this._cleanTargeting(r.getTargeting(e))}catch(h){}return bt(i,d)}setAdServerTargeting(t,e,r){let i=this.core.get(w).getGptSlot(t);if(i!=null)try{i.setTargeting(e,r)}catch(d){}}_cleanTargeting(t){return typeof t=="string"?[t]:t instanceof Array?t.filter(e=>typeof e=="string"):[]}};o(gt,"GoogletagTargeting"),gt=s([g],gt);var k=class{_onAdRequested(t){this.core.get(v).setAdRequested(t)}_onAdRendered(t,e){this.core.get(v).setAdRendered(t,e)}_onAdRemoved(t){this.core.get(v).setAdRemoved(t)}_getAdServerTargeting(t,e){return t.source!=="gpt"?[]:this.core.get(gt).getAdServerTargeting(t,e)}_setAdServerTargeting(t,e,r){t.source==="gpt"&&this.core.get(gt).setAdServerTargeting(t,e,r)}};o(k,"Googletag"),s([p(rt,"adRequested")],k.prototype,"_onAdRequested",1),s([p(rt,"adRendered")],k.prototype,"_onAdRendered",1),s([p(et,"adRemoved")],k.prototype,"_onAdRemoved",1),s([p(R,"getAdServerTargeting")],k.prototype,"_getAdServerTargeting",1),s([p(R,"setAdServerTargeting")],k.prototype,"_setAdServerTargeting",1),k=s([g],k);var Gr="https://vtrk.doubleverify.com",nr="dvtag",Hr=1,jr=1,P=class{constructor(){a(this,"sharedDataPoints")}_onAdRequestCompleted(t){if(t.index!==0)return;let{timeoutValue:e,onDvtagReadyCalled:r,callbackCalled:i}=t,d=i!=null?i-r:e;this.fireEvent("ad-request",{cd111:t.status,cm106:t.index,cm107:d,cd112:t.internal?"legacy":"modern"},{sampleInterval:jr})}_handleError(t){this.fireEvent("log",{cd111:"error",cd112:t.message,cd113:t.trace.join("=>")},{sampleInterval:Hr})}_getSharedDataPoints(){if(this.sharedDataPoints==null){let t=this.core.get(b),e=this.core.get(Q),r=this.core.get(C),{ctx:i,cmp:d,legacy:u}=t.getTagInfo(),m=r.getHostname(),h=t.getSessionUuid(),f=e.getShortCommitId();this.sharedDataPoints={cd102:f,cd103:"",cd107:h,cd109:u?"legacy":"modern",cd108:"",cd105:i,cd106:d,cd104:m}}return this.sharedDataPoints}fireEvent(t,e,{sampleInterval:r=1,trackerUuid:i=ht(),spoofWrapperId:d=!1}={}){if(Math.random()>=1/r)return;e=Mt(ct(ct({},e),this._getSharedDataPoints()),{cd101:t,cm101:r});let u=Mt(ct({ec:nr,ea:e.cd101,ctx:d?nr:e.cd105,cmp:e.cd106},e),{cid:i,t:"event",v:1,z:i,cd160:i}),m=new URL(Gr);for(let[h,f]of Object.entries(u))f!=null&&m.searchParams.set(h,`${f}`);this._sendBeacon(m.href)}_sendBeacon(t){try{typeof(navigator==null?void 0:navigator.sendBeacon)=="function"?navigator.sendBeacon(t):new Image().src=t}catch(e){}}};o(P,"Events"),s([p(E,"adRequestCompleted")],P.prototype,"_onAdRequestCompleted",1),s([Ne],P.prototype,"_handleError",1),P=s([g],P);var zr=.01,$=class{constructor(){a(this,"plugins",{overrideActivationRate:o(()=>[],"overrideActivationRate")});a(this,"_random",Math.random);a(this,"_falconEnabled")}isFalconEnabled(){var t;if(this._falconEnabled==null){let e=(t=this.plugins.overrideActivationRate()[0])!=null?t:zr;this._falconEnabled=this._random()<e}return this._falconEnabled}};o($,"FalconTest"),$=s([g],$);var W=class{constructor(){a(this,"_count",0);a(this,"plugins",{onCountUpdated:o(t=>[],"onCountUpdated")})}getCount(){return this._count}increment(){this._count+=1,this.plugins.onCountUpdated(this._count)}decrement(){this._count-=1,this.plugins.onCountUpdated(this._count)}};o(W,"MeasurementScriptCounter"),W=s([g],W);var Kr="blockingtime",Yr=5*60*1e3,$r=60*1e3,Wr=20;var ot=class{constructor(){a(this,"trackerCount",0);a(this,"monitorStart",0);a(this,"lastAvgScriptCountUpdate",0);a(this,"summedBlockingTime",0);a(this,"totalLongTaskTime",0);a(this,"longTaskCount",0);a(this,"avgScriptCountNumerator",0);a(this,"currentScriptCount",0);a(this,"lastTrackerSent",0);a(this,"scriptInsertions",0);a(this,"scriptFlavor","?");a(this,"observer");a(this,"visibilityListener",o(()=>{this.core.window.document.hidden&&this._sendTracker()},"visibilityListener"));a(this,"finalTrackerTimeout")}_initialize(){var i;let{PerformanceObserver:t,setTimeout:e,addEventListener:r}=this.core.window;this.scriptFlavor=this.core.get($).isFalconEnabled()?"falcon":"cdn",!(t==null||!((i=t.supportedEntryTypes)!=null&&i.includes("longtask")))&&(this.observer=new t(d=>d.getEntries().forEach(u=>{let m=Math.max(0,u.duration-50);this.totalLongTaskTime+=u.duration,this.longTaskCount+=1,this.summedBlockingTime+=m})),this.observer.observe({type:"longtask",buffered:!0}),this.monitorStart=Date.now(),this.lastAvgScriptCountUpdate=Date.now(),r("visibilitychange",this.visibilityListener),this.finalTrackerTimeout=e(()=>{this._sendTracker(),this.disable()},Yr))}_onScriptCountUpdate(t){this.scriptInsertions+=t>this.currentScriptCount?1:0,this._updateAvgScriptCount(),this.currentScriptCount=t}_updateAvgScriptCount(){this.avgScriptCountNumerator+=this.currentScriptCount*(Date.now()-this.lastAvgScriptCountUpdate),this.lastAvgScriptCountUpdate=Date.now()}_sendTracker(){if(Date.now()-this.lastTrackerSent<$r)return;this._updateAvgScriptCount();let t=Date.now()-this.monitorStart,e={cd110:this.scriptFlavor,cm106:this.trackerCount,cm107:t,cm108:this.summedBlockingTime,cm109:this.totalLongTaskTime,cm110:this.longTaskCount,cm111:this.avgScriptCountNumerator/t,cm112:this.scriptInsertions};this.core.get(P).fireEvent(Kr,e,{spoofWrapperId:!0}),this.trackerCount+=1,this.lastTrackerSent=Date.now(),this.trackerCount>=Wr&&this.disable()}disable(){var r;let{removeEventListener:t,clearTimeout:e}=this.core.window;(r=this.observer)==null||r.disconnect(),t("visibilitychange",this.visibilityListener),e(this.finalTrackerTimeout)}};o(ot,"BlockingTimeMonitor"),s([D],ot.prototype,"_initialize",1),s([p(W,"onCountUpdated")],ot.prototype,"_onScriptCountUpdate",1),ot=s([g],ot);var ir=o((n,t,e="")=>{if(n.length<=t)return n;let r=t-e.length;return r<0?e:n.slice(0,r)+e},"truncate");var sr="https://cdn.doubleverify.com/dvtp_src.js",ar="https://cdn.dv.tech/dvbm.js";var dr={cmp:"cmp",ctx:"ctx",isSellerTag:"seltag",blocking:"blk",t2te:"t2te",deepIFrameClickHandlers:"dich",measurementActivationPath:"dvp_pubaap",unityTagBuildTimestamp:"dvp_uptbts",unityTagBuildCommitId:"dvp_uptbcid",adServerCode:"adsrv",adServerId:"dvp_gptmasid",pageVisitId:"dvp_uptpid",slotId:"dvp_uptsid",slotElementId:"dvp_uptseid",selectedVariation:"dvp_gptmvr",selectedVariationFraction:"dvp_gptmvrfr",customDimension1:"c1",customDimension2:"c2",customDimension3:"c3",customDimension4:"c4",customDimension5:"c5",customDimension6:"c6",customDimension7:"c7",customDimension8:"c8",customDimension9:"c9",customDimension10:"c10",adPosition:"spos",qtPageId:"dvp_qtpid",qtSlotId:"dvp_qtsid",headerBidding:"dvp_gptmhb",advertiserId:"sadv",orderId:"ord",lineItemId:"litm",creativeId:"scrt",placementCode:"splc",size:"unit",slotAdCount:"dvp_uptsacnt",locatedElementType:"dvp_gptmle",adLocationMechanism:"alm",btreg:"btreg",btattb:"btattb",bttag:"bttag",btadsrv:"btadsrv",detectedAdFormats:"dvp_pubdaf",adTargetingError:"dvp_pubate",creativeWrapperAvailable:"dvp_gptmcw",isFalconTestEnabledDVP:"dvp_pubaft",isFalconTestEnabledEE:"ee_dp_pubaft",measurementInjectionStrategy:"dvp_gptmit"};var O=class{constructor(){a(this,"parameters",new I);a(this,"_truncate",ir);a(this,"_isCrossOriginIframe",Rt)}_set(t,e){Object.assign(this.parameters.getOrDefault(t,{}),e)}_getScriptUrl(t){let e=new URLSearchParams,r=this.parameters.getOrDefault(t,{});for(let[d,u]of Object.entries(r)){let m=dr[d];u!=null&&e.set(m,`${u}`)}let i=new URL(this.core.get($).isFalconEnabled()?ar:sr);return i.hash=e.toString(),i.href}createScriptElement(t,e){var u;let r=this._getScriptUrl(t),d=this.core.get(C).getDocument().createElement("script");return d.setAttribute("src",r),d.setAttribute("async",""),d.dvAdElement=(u=e.parentIframe)!=null?u:e.element,d}setIdentifiers(t){let{ctx:e,cmp:r}=this.core.get(b).getTagInfo();this._set(t,{ctx:e,cmp:r})}setConstants(t){this._set(t,{isSellerTag:1,t2te:0,blocking:this.core.get($).isFalconEnabled()?0:void 0,measurementActivationPath:2,deepIFrameClickHandlers:1,unityTagBuildTimestamp:this.core.get(Q).getBuildTimestamp(),unityTagBuildCommitId:this.core.get(Q).getShortCommitId()})}setAdUnit(t){this._set(t,{adServerCode:"104",adServerId:this.core.get(L).getAdServerId(t.adUnit.network),pageVisitId:this.core.get(b).getVisitUuid(),slotId:t.uuid,slotElementId:this._truncate(t.elementId,30,"~")})}_getCustomDimension(t,e){var d;let i=(d=this.core.get(L).getAdServerCustomTracking(t.adUnit.network)[e])==null?void 0:d.key;return i!=null?this.core.get(R).getAdServerTargeting(t,i).join(","):void 0}setCustomDimensions(t){this._set(t,{customDimension1:this._getCustomDimension(t,"c1"),customDimension2:this._getCustomDimension(t,"c2"),customDimension3:this._getCustomDimension(t,"c3"),customDimension4:this._getCustomDimension(t,"c4"),customDimension5:this._getCustomDimension(t,"c5"),customDimension6:this._getCustomDimension(t,"c6"),customDimension7:this._getCustomDimension(t,"c7"),customDimension8:this._getCustomDimension(t,"c8"),customDimension9:this._getCustomDimension(t,"c9"),customDimension10:this._getCustomDimension(t,"c10")})}_getAdPosition(t){let e=this.core.get(L).getAdPositionKey(t.adUnit.network);return this.core.get(R).getAdServerTargeting(t,e)[0]}setQualityTargeting(t){this._set(t,{adPosition:this._getAdPosition(t),qtPageId:this.core.get(b).getVisitUuid(),qtSlotId:t.uuid})}_sizeToString(t){return Array.isArray(t)?`${t[0]}x${t[1]}`:t}setAdInstance(t,e){this._set(t,{advertiserId:e.advertiserId,orderId:e.campaignId,lineItemId:e.lineItemId,creativeId:e.creativeId,placementCode:t.adUnit.id,size:this._sizeToString(e.renderedSize)})}setEngagement(t){this._set(t,{slotAdCount:this.core.get(v).getNonEmptyAdRenderedCount(t)})}_getLocatedElementType(t){let e=this.core.get(C).getWindow(),{element:r,parentIframe:i}=t;return r==null?0:i!=null?4:r instanceof HTMLIFrameElement?this._isCrossOriginIframe(r,e)?2:1:0}setAdLocation(t,e){this._set(t,{locatedElementType:this._getLocatedElementType(e),adLocationMechanism:"manual"})}setCustomAdFormat(t,e){e!=null&&this._set(t,ct({adLocationMechanism:void 0},e))}setDebug(t){this._set(t,{isFalconTestEnabledDVP:1,isFalconTestEnabledEE:1,measurementInjectionStrategy:0})}};o(O,"MeasurementScript"),O=s([g],O);var mt=class{constructor(){a(this,"_setIframeContent",er);a(this,"_addElement",Jt);a(this,"iframeElements",new I)}_applyDebugInfo(t,e){e.setAttribute("id",`gptm-${t.elementId}`),e.dataset.slotId=t.uuid,e.dataset.slotAdCount=`${this.core.get(v).getNonEmptyAdRenderedCount(t)}`}injectScriptElement(t,e){let r=this.core.get(C).getDocument(),i=r.createElement("iframe");i.style.display="none",this.iframeElements.set(t,i),this._applyDebugInfo(t,i),this._addElement(r.body,i),this._setIframeContent(i,e)}removeScriptElement(t){var e;try{(e=this.iframeElements.get(t))==null||e.remove(),this.iframeElements.delete(t)}catch(r){}}};o(mt,"MeasurementScriptInjection"),mt=s([g],mt);var lr=o((n,t)=>n.filter(e=>e.detect(t)),"detectAdFormats");var te=o((n,t)=>{let e=null,r=[],i=0;t!=null&&(r=lr(n,t),r.length===1&&(e=r[0].target(t))),e==null&&(t==null&&(i|=1),r.length>1&&(i|=2),r.length===1&&(i|=4));let d={detectedAdFormats:r};return i>0&&(d.adTargetingErrorCode=i),{adTarget:e,diagnostics:d}},"getAdFormatsTargeting");var Xr=2e3,cr=o(n=>n.readyState==="interactive"||n.readyState==="complete","isDocumentReady"),ee=o((r,i,...d)=>S(void 0,[r,i,...d],function*(n,t,e=Xr){var f;let u=(f=n.parentIframe)!=null?f:n.element;if(!(u instanceof HTMLIFrameElement))return"no-iframe";let m=Dt(u);if(m==null||Rt(u,t))return"cross-origin";let h;try{h=cr(m)}catch(A){return"error"}return h?"prev-ready":yield new Promise(A=>{let M=o(()=>{let _;try{_=cr(m)}catch(B){q("error");return}_&&q("state-change")},"listener"),q=o(_=>{try{m.removeEventListener("readystatechange",M)}catch(B){}A(_)},"cleanupAndResolve");try{m.addEventListener("readystatechange",M)}catch(_){A("error")}setTimeout(()=>q("timeout"),e)})}),"waitForIFrameReadyState");var Jr=[],nt=class{constructor(){a(this,"plugins",{overrideCustomAdFormats:o(()=>[],"overrideCustomAdFormats")});a(this,"_getAdFormatsTargeting",te);a(this,"_waitForIFrameReadyState",ee)}_getContextNode(t){let e=t.element;if(t.parentIframe!=null)try{e=t.parentIframe.contentDocument}catch(r){}return e}_getAdFormats(){var t;return(t=this.plugins.overrideCustomAdFormats()[0])!=null?t:Jr}_encodeDetectedAdFormats(t){return t.map(e=>e.id).reduce((e,r)=>e|r,0)}_detectAdFormatInHtml(t,e){var r;return e==null?null:(r=t.find(i=>i.detectInHtml(e)))!=null?r:null}detectCustomAdFormat(t,e){return S(this,null,function*(){var A,M,q;let r=this._getAdFormats(),i=this._detectAdFormatInHtml(r,e.html),d=Date.now(),u;if(i!=null){let _=this.core.get(C).getWindow();u=yield this._waitForIFrameReadyState(t,_)}let m=Date.now()-d,{adTarget:h,diagnostics:f}=this._getAdFormatsTargeting(r,this._getContextNode(t));return this.core.get(P).fireEvent("detect-custom-ad-format",{cd120:u,cd130:(A=i==null?void 0:i.name)!=null?A:"default",cd131:(q=(M=f.detectedAdFormats[0])==null?void 0:M.name)!=null?q:"default",cm120:m},{sampleInterval:100,spoofWrapperId:!0}),h==null?null:Mt(ct(ct({},h),f),{detectedAdFormats:this._encodeDetectedAdFormats(f.detectedAdFormats)})})}};o(nt,"CustomAdFormats"),nt=s([g],nt);var it=class{constructor(){a(this,"deduplicationSet",new I);a(this,"deduplicationReliable",new I)}_setDeduplicationTargeting(t){this.core.get(R).setSlotTargeting(t,{dv_upt_cwm:["0"]}),this.deduplicationSet.set(t,!0)}_onAdRequested(t){this.deduplicationReliable.set(t,this.deduplicationSet.get(t)===!0)}isDeduplicationReliable(t){return this.deduplicationReliable.get(t)===!0}};o(it,"DuplicateMeasurement"),s([p(T,"slotDiscovered")],it.prototype,"_setDeduplicationTargeting",1),s([p(v,"adRequested")],it.prototype,"_onAdRequested",1),it=s([g],it);var st=class extends x{_isEligibleForMeasurement(t){return t.source==="custom"||this.core.get(L).isAdServerConfigured(t.adUnit.network)}_isReadyForMeasurement(t){return this._isEligibleForMeasurement(t)&&(t.source==="custom"||this.core.get(it).isDeduplicationReliable(t))}_onSlotDiscovered(t){this._isEligibleForMeasurement(t)&&(this.core.get(O).setIdentifiers(t),this.core.get(O).setConstants(t),this.core.get(O).setAdUnit(t))}_onAdRequested(t){this._isEligibleForMeasurement(t)&&(this.core.get(O).setCustomDimensions(t),this.core.get(O).setQualityTargeting(t))}_onAdRendered(t,e,r){return S(this,null,function*(){if(e==null||!this._isReadyForMeasurement(t))return;this.core.get(O).setAdInstance(t,e),this.core.get(O).setEngagement(t),this.core.get(O).setAdLocation(t,r),this.core.get(O).setDebug(t);let i=yield this.core.get(nt).detectCustomAdFormat(r,e);this.core.get(O).setCustomAdFormat(t,i);let d=this.core.get(O).createScriptElement(t,r);this.core.get(W).increment(),this.core.get(mt).injectScriptElement(t,d)})}_onAdRemoved(t){this.core.get(W).decrement(),this.core.get(mt).removeScriptElement(t)}};o(st,"GptMeasurement"),s([p(T,"slotDiscovered")],st.prototype,"_onSlotDiscovered",1),s([p(v,"adRequestedOrInferred")],st.prototype,"_onAdRequested",1),s([p(v,"adRendered")],st.prototype,"_onAdRendered",1),s([p(v,"adRemoved")],st.prototype,"_onAdRemoved",1),st=s([g,N(k),N(ot)],st);var Nt=o(n=>n,"asStrictString"),re=o(n=>n,"castAsStrictString");var Zr=o(n=>{var t;return(t=n.ownerDocument)!=null?t:n},"getDocument");var ur=o((n,t)=>Zr(t).evaluate(n,t,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),"getAllNodesByXpath"),Lt=o((n,t)=>ur(n,t).iterateNext()!=null,"hasXpathMatches"),to=o(n=>(n==null?void 0:n.nodeType)===Node.ELEMENT_NODE?n:null,"nodeToElement");var oe=o((n,t)=>{let e=[],r=ur(n,t),i=r.iterateNext();for(;i!=null;){let d=to(i);d!=null&&e.push(d),i=r.iterateNext()}return e},"getAllElementsByXpath");var eo='.//div[@id="labBG"]',ro=/<div[^>]*id\s*=\s*(['"])\s*labBG\s*\1/,ne={name:"Weather Channel - Integrated Marquee Large Web",id:1,detect:o(n=>Lt(eo,n),"detect"),detectInHtml:o(n=>ro.test(n),"detectInHtml"),target:o(()=>({btreg:Nt("labBG")}),"target")};var Pt=class{_overrideCustomAdFormats(){return[ne]}};o(Pt,"WeatherConfig"),s([p(nt,"overrideCustomAdFormats")],Pt.prototype,"_overrideCustomAdFormats",1),Pt=s([g],Pt);var _t=o(()=>{var n,t,e;return Math.floor((e=(t=(n=window.performance)==null?void 0:n.now)==null?void 0:t.call(n))!=null?e:Date.now())},"perfNowOrDateNow");var be=class be{constructor(){a(this,"_firstQueuedAdRequest",1/0);a(this,"_lastQueuedAdRequest",-1/0);a(this,"_firstReleasedAdRequest",1/0);a(this,"_lastReleasedAdRequest",-1/0);a(this,"_lastReleasedAdRequestTime",null);a(this,"_hasBeenSuccessful",!1)}setAdRequestQueued(t){this._firstQueuedAdRequest=Math.min(this._firstQueuedAdRequest,t),this._lastQueuedAdRequest=Math.max(this._lastQueuedAdRequest,t)}setAdRequestReleased(t){this._firstReleasedAdRequest=Math.min(this._firstReleasedAdRequest,t),this._lastReleasedAdRequest=Math.max(this._lastReleasedAdRequest,t),this._lastReleasedAdRequestTime=_t()}getLastQueuedAdRequest(){return Number.isFinite(this._lastQueuedAdRequest)?this._lastQueuedAdRequest:null}getLastReleasedAdRequest(){return Number.isFinite(this._lastReleasedAdRequest)?this._lastReleasedAdRequest:null}getLastReleasedAdRequestTime(){return this._lastReleasedAdRequestTime}getLastSuccessfulAdRequest(){let t=Math.max(this._firstQueuedAdRequest,this._firstReleasedAdRequest),e=Math.min(this._lastQueuedAdRequest,this._lastReleasedAdRequest);return e<t?null:e}getPreviouslySuccessful(){return this._hasBeenSuccessful}markAdServerAdRequest(){this.getLastSuccessfulAdRequest()!=null&&(this._hasBeenSuccessful=!0),this._firstQueuedAdRequest=1/0,this._lastQueuedAdRequest=-1/0,this._firstReleasedAdRequest=1/0,this._lastReleasedAdRequest=-1/0,this._lastReleasedAdRequestTime=null}};o(be,"SlotAdRequestTracker");var ie=be;var se=(u=>(u.UNKNOWN="UNKNOWN",u.SEEN="SEEN",u.NOT_READY="NOT_READY",u.POSSIBLE_TIMEOUT="POSSIBLE_TIMEOUT",u.PREV_READY="PREV_READY",u.READY="READY",u))(se||{});var Ce="dv_upt_slot_ready",oo=["https://securepubads.g.doubleclick.net/gampad/ads?","https://pagead2.googlesyndication.com/gampad/ads?"],no=750,F=class{constructor(){a(this,"plugins",{onSlotRequested:o(()=>[],"onSlotRequested"),onSlotRequestValidated:o(()=>[],"onSlotRequestValidated")});a(this,"validateAdRequests",!1);a(this,"lastAdRequestQueued",null);a(this,"lastAdRequestReleased",null);a(this,"state",{adRequestTracker:new I,triggered:new I})}_getSlotAdRequestTracker(t){return this.state.adRequestTracker.getOrDefaultFromFunction(t,()=>new ie)}_onAdRequestQueued({index:t}){this.lastAdRequestQueued=t;for(let e of this.core.get(T).getSlots())this._getSlotAdRequestTracker(e).setAdRequestQueued(t),this.state.triggered.set(e,!1)}_onAdRequestBeforeRelease({index:t}){let e=this.core.get(R);this.lastAdRequestReleased=t;for(let r of this.core.get(T).getSlots())this._getSlotAdRequestTracker(r).setAdRequestReleased(t),this.validateAdRequests&&e.setSlotTargeting(r,{[Ce]:["1"]})}_onSlotDiscovered(t,e){e===0&&this.lastAdRequestQueued!=null&&this._getSlotAdRequestTracker(t).setAdRequestQueued(this.lastAdRequestQueued)}_determineReadyState(t){let e=this._getSlotAdRequestTracker(t),r=e.getLastQueuedAdRequest(),i=e.getLastSuccessfulAdRequest(),d=e.getPreviouslySuccessful();return i!=null?"READY":d?"PREV_READY":r!=null?"NOT_READY":Date.now()-t.creationTime>no?"SEEN":"UNKNOWN"}getSlotReadyStateOnAdServerAdRequest(t){let e=this._determineReadyState(t);if(e==="READY"){if(this.state.triggered.get(t)===!0)return{readyState:"PREV_READY"};this.state.triggered.set(t,!0);let r=this._getSlotAdRequestTracker(t).getLastReleasedAdRequestTime();return{readyState:e,readyFor:_t()-r}}return{readyState:e}}_onSlotRequested(t){let{readyState:e,readyFor:r}=this.getSlotReadyStateOnAdServerAdRequest(t);this._getSlotAdRequestTracker(t).markAdServerAdRequest(),this.validateAdRequests&&this.core.get(R).setSlotTargeting(t,{[Ce]:["0"]}),this.plugins.onSlotRequested(t,e,r)}enableAdRequestValidation(){if(!this.validateAdRequests)try{let t=this._processResourceRequest.bind(this);new PerformanceObserver(r=>r.getEntries().forEach(t)).observe({type:"resource"}),this.validateAdRequests=!0}catch(t){}}_processResourceRequest(t){var e,r,i;try{if(oo.every(m=>!t.name.startsWith(m)))return;let u=(r=(e=new URL(t.name).searchParams.get("prev_scp"))==null?void 0:e.split("|"))!=null?r:[];for(let m of u){let f=((i=new URLSearchParams(m).get(Ce))==null?void 0:i[0])==="1";this.plugins.onSlotRequestValidated(f)}}catch(d){}}};o(F,"SlotReadinessTracker"),s([p(E,"adRequestQueued")],F.prototype,"_onAdRequestQueued",1),s([p(E,"adRequestBeforeRelease"),p(E,"adRequestTimedOut")],F.prototype,"_onAdRequestBeforeRelease",1),s([p(T,"slotDiscovered")],F.prototype,"_onSlotDiscovered",1),s([p(v,"adRequested")],F.prototype,"_onSlotRequested",1),F=s([g],F);var Ie="__dvtag_debug_mode",mr="1",K=class{constructor(){a(this,"enabled",!1);a(this,"debugScriptLoaded",o(t=>{},"debugScriptLoaded"));a(this,"debugScriptLoadedPromise",new Promise(t=>{this.debugScriptLoaded=t}))}_initialize(){try{this.enabled=window===window.top&&this.core.window.sessionStorage.getItem(Ie)===mr}catch(t){}this.enabled&&(this.core.get(E).delayAdRequests(this.debugScriptLoadedPromise),this._loadDebugScript())}_toggleDebugMode(){return S(this,null,function*(){this.enabled?this.core.window.sessionStorage.removeItem(Ie):this.core.window.sessionStorage.setItem(Ie,mr),this.core.window.location.reload()})}_onDebugScriptLoaded(){this.debugScriptLoaded(void 0)}_loadDebugScript(){return S(this,null,function*(){let{ctx:t,cmp:e}=this.core.get(b).getTagInfo(),{document:r}=this.core.window,i=tr(`https://pub.doubleverify.com/dvtag/${t}/${e}/debug.js`,!0);r.readyState==="loading"&&(yield new Promise(d=>r.addEventListener("DOMContentLoaded",()=>d(void 0)))),r.head.appendChild(i)})}_onAdRequestEvent(t){var e;(e=window.dvtagDebug)==null||e.adRequestEvent(t)}};o(K,"DebugScriptLoader"),s([D],K.prototype,"_initialize",1),s([ut("toggleDebugMode")],K.prototype,"_toggleDebugMode",1),s([ut("_debugScriptLoaded")],K.prototype,"_onDebugScriptLoaded",1),s([p(E,"adRequestQueued"),p(E,"adRequestBeforeRelease"),p(E,"adRequestTimedOut")],K.prototype,"_onAdRequestEvent",1),K=s([N(F),g],K);var we="qt_loaded",ae="pts_pid",pr="pts_sid";var xe=o(n=>[...new Set(n.filter(He).map(t=>t.toLowerCase()))],"getGreenlightSignal");var at=class extends x{_autoInsertPageId(){this.core.get(R).setGlobalTargeting({[ae]:[this.core.get(b).getVisitUuid()]})}_autoInsertSlotId(t){this.core.get(R).setSlotTargeting(t,{[pr]:[t.uuid]})}_autoInsertGlobalTargeting(t){this.core.get(R).setGlobalTargeting({[we]:xe(Object.keys(t))},!0)}_autoInsertSlotTargeting(t,e){this.core.get(R).setSlotTargeting(t,{[we]:xe(Object.keys(e))},!0)}};o(at,"SignalsAutoInsertion"),s([p(b,"newVisit")],at.prototype,"_autoInsertPageId",1),s([p(T,"slotDiscovered")],at.prototype,"_autoInsertSlotId",1),s([p(y,"userTargetingUpdated"),p(y,"pageTargetingUpdated")],at.prototype,"_autoInsertGlobalTargeting",1),s([p(y,"slotTargetingUpdated")],at.prototype,"_autoInsertSlotTargeting",1),at=s([g,N(k),N(K)],at);var io=ae,X=class{constructor(){a(this,"restoreCount",0)}getRestoreCount(){return this.restoreCount}_restoreTargeting(){let t=this.core.get(R);for(let e of this.core.get(T).getSlots())t.getAdServerTargeting(e,io).length===0&&(t.setAdServerTargeting(e),this.restoreCount+=1)}};o(X,"TargetingRestorer"),s([p(E,"adRequestQueued")],X.prototype,"_restoreTargeting",1),X=s([g],X);var De=class De{constructor(){a(this,"total",0);a(this,"dataPoints",0)}push(t){return this.total+=t,this.dataPoints+=1,this}get(){return this.total/this.dataPoints}getRounded(){return Math.round(this.get())}};o(De,"Average");var Ht=De;var so="implcheck",ao=1e-4,lo=5e3,co=5,Y=class{constructor(){a(this,"enabled",!1);a(this,"totalInternalAdRequestQueuedCount",0);a(this,"totalAdRequestsCompletedCount",0);a(this,"totalSlotsRequestedCount",0);a(this,"totalSlotsRequestedOkCount",0);a(this,"totalTimeoutCount",0);a(this,"trackersSent",0);a(this,"totalValidatedAdServerRequests",{ok:0,notOk:0});a(this,"lastOnDvtagReadyCall",NaN);a(this,"slotReqAvgTimeSinceCall",new Ht);a(this,"slotReqAvgTimeSinceDone",new Ht);a(this,"batch",null)}isDebugForceEnabled(){return!1}_initialize(){this.enabled=this.core.get(Y).isDebugForceEnabled()||Math.random()<ao,this.enabled&&this.core.get(F).enableAdRequestValidation()}_onAdRequestQueued(t){this.enabled&&(this.lastOnDvtagReadyCall=_t(),t.internal&&(this.totalInternalAdRequestQueuedCount+=1))}_onAdRequestCompleted(t){this.enabled&&(this.totalAdRequestsCompletedCount+=1,(t.status==="tag-timeout"||t.status==="queue-timeout")&&(this.totalTimeoutCount+=1))}_onSlotRequested(t,e,r){if(!this.enabled)return;let i=this._getOrStartBatch();this.totalSlotsRequestedCount+=1,e==="READY"&&(this.totalSlotsRequestedOkCount+=1),i.slots[e].push(t.elementId),r!=null&&(this.slotReqAvgTimeSinceDone.push(r),this.slotReqAvgTimeSinceCall.push(_t()-this.lastOnDvtagReadyCall));let d=this._validateAdServerTargeting(t);d===1?i.targeting.extendedCount+=1:d===0&&(i.targeting.reducedCount+=1)}_validateAdServerTargeting(t){let e=this.core.get(R),r=2,i=e.getTargeting(t);for(let[d,u]of Object.entries(i)){let m=e.getAdServerTargeting(t,d);if(u.length>m.length||u.some(h=>!m.includes(h)))return 0;m.length>u.length&&(r=1)}return r}_onSlotRequestValidated(t){t?this.totalValidatedAdServerRequests.ok+=1:this.totalValidatedAdServerRequests.notOk+=1}_sendTracker(){let t=this.core.get(X).getRestoreCount(),{slots:e,targeting:r,start:i}=this._getOrStartBatch(),d={cd110:e.READY.join(),cd111:e.PREV_READY.join(),cd112:e.SEEN.join(),cd113:e.NOT_READY.join(),cd114:e.UNKNOWN.join(),cd115:e.POSSIBLE_TIMEOUT.join(),cm106:this.trackersSent,cm107:i,cm109:this.totalTimeoutCount,cm110:this.slotReqAvgTimeSinceCall.getRounded(),cm111:this.slotReqAvgTimeSinceDone.getRounded(),cm112:this.totalSlotsRequestedOkCount,cm113:this.totalValidatedAdServerRequests.ok,cm114:this.totalValidatedAdServerRequests.notOk,cm115:t,cm116:this.totalAdRequestsCompletedCount,cm117:this.totalInternalAdRequestQueuedCount,cm118:this.totalSlotsRequestedCount,cm119:r.reducedCount,cm120:r.extendedCount};this.core.get(P).fireEvent(so,d),this.batch=null,this.trackersSent+=1,this.trackersSent>=co&&(this.enabled=!1)}_getOrStartBatch(){return this.batch==null&&(this.batch={start:_t(),slots:Object.fromEntries(Object.values(se).map(t=>[t,[]])),targeting:{extendedCount:0,reducedCount:0}},setTimeout(()=>this._sendTracker(),lo)),this.batch}};o(Y,"ImplementationValidator"),s([D],Y.prototype,"_initialize",1),s([p(E,"adRequestQueued")],Y.prototype,"_onAdRequestQueued",1),s([p(E,"adRequestCompleted")],Y.prototype,"_onAdRequestCompleted",1),s([p(F,"onSlotRequested")],Y.prototype,"_onSlotRequested",1),s([p(F,"onSlotRequestValidated")],Y.prototype,"_onSlotRequestValidated",1),Y=s([g],Y);var dt=class{_defineSlot(t,e={}){if(typeof t!="string"||e==null||typeof e!="object")return;let r={id:V(e.id),network:V(e.network),sizes:e.sizes!=null?Ut(e.sizes):void 0,position:V(e.position)};this.core.get(T).createSlot("custom",0,t,r)}_adRendered(t,e){if(typeof t!="string"||e==null||typeof e!="object")return;let r=this.core.get(T).getSlot("custom",t);if(r==null)return;let i={advertiserId:V(e.advertiserId),campaignId:V(e.campaignId),creativeId:V(e.creativeId),lineItemId:V(e.lineItemId),renderedSize:Zt(e.renderedSize)};this.core.get(v).setAdRendered(r,i)}_adRemoved(t){if(typeof t!="string")return;let e=this.core.get(T).getSlot("custom",t);e!=null&&this.core.get(v).setAdRemoved(e)}_getTargeting(t){let e=this.core.get(R);if(typeof t!="string")return e.getTargeting();let r=this.core.get(T).getSlot("custom",t);return e.getTargeting(r)}};o(dt,"CustomAdServer"),s([ut("defineSlot")],dt.prototype,"_defineSlot",1),s([ut("getTargeting")],dt.prototype,"_getTargeting",1),dt=s([g],dt);var fr=o(()=>{let n;try{n=crypto.randomUUID()}catch(t){n=String(Math.random()*1e12)}return n},"getRandomId");var uo="celtra-ad-v",hr=`.//div[contains(concat(' ', @class), ' ${uo}')]`,go=/<div[^>]*class\s*=\s*(['"])(?:(?:(?!\1)\S)+\s+)*\s*celtra-ad-v/,Sr="data-dv-id",mo=o(n=>{let t=n;return t.celtra!=null&&t.celtra.viewabilityObservee!=null},"isCeltraElement"),Tr={name:"Celtra",id:2,detect:o(n=>Lt(hr,n),"detect"),detectInHtml:o(n=>go.test(n),"detectInHtml"),target:o(n=>{try{let t=oe(hr,n);if(t.length!==1)return null;let e=t[0],r=fr();fo(e,r);let i=`^${r}$`;return{btreg:re(i),btattb:Nt(Sr)}}catch(t){return null}},"target")},po=o((n,t)=>mo(n)?(n.celtra.viewabilityObservee.setAttribute(Sr,t),!0):!1,"tryAddTargetingInfo"),fo=o((n,t,e=100,r=200)=>{let i=0,d=o(()=>{po(n,t)||i>=e||(i++,setTimeout(d,r))},"attempt");d()},"addTargetingInfo");var Rr="ccfid",ho="data-cc-id",Ar=`.//script[contains(@id,"${Rr}")]`,So=/<script[^>]*id\s*=\s*(['"])\s*ccfid(?:(?!\1).)*\1/,To=o(n=>{if(n==null)throw new Error("Clipcentric script node is null");if(n.hasAttribute("id")===!1)throw new Error("Clipcentric script node does not have an id attribute");let t=n.getAttribute("id");if(t==null)throw new Error("Clipcentric script node id attribute is null");return t.replace(Rr,"")},"extractID"),Er={name:"Clipcentric",id:4,detect:o(n=>Lt(Ar,n),"detect"),detectInHtml:o(n=>So.test(n),"detectInHtml"),target:o(n=>{try{let t=oe(Ar,n);if(t.length!==1)return null;let e=t[0],r=`^${To(e)}$`;return{btreg:re(r),btattb:Nt(ho)}}catch(t){return null}},"target")};var Ao="iframe-ready-experiment",Ro=1/1e5,_r=[Er,Tr,ne],pt=class{constructor(){a(this,"_waitForIFrameReadyState",ee);a(this,"_isCrossOriginIframe",Rt);a(this,"_getAdFormatsTargeting",te)}_shouldActivate(t=Ro){return Math.random()<=t}_detectCustomAdFormatInNode(t){var d,u,m;let{diagnostics:e}=this._getAdFormatsTargeting(_r,t),r=(u=(d=e.detectedAdFormats[0])==null?void 0:d.name)!=null?u:"default",i=(m=e.adTargetingErrorCode)!=null?m:0;return{adFormat:r,errorCode:i}}_detectCustomAdFormatInHtml(t){let e=null;try{e=this.core.get(C).getDOMParser().parseFromString(t,"text/html")}catch(r){}return this._detectCustomAdFormatInNode(e)}_detectCustomAdFormatInHtmlWithRegEx(t){var e,r;return{adFormat:(r=(e=_r.find(i=>i.detectInHtml(t)))==null?void 0:e.name)!=null?r:"default",errorCode:0}}_detectCustomAdFormatInDom(t){let e=null;try{e=t.contentDocument}catch(r){}return this._detectCustomAdFormatInNode(e)}_onAdRendered(t,e,r){return S(this,null,function*(){var Pe,Oe,Ue;if(!this._shouldActivate())return;let i=this.core.get(C).getWindow(),d=e==null,u=(Pe=r.parentIframe)!=null?Pe:r.element,m=u instanceof HTMLIFrameElement,h=m&&this._isCrossOriginIframe(u,i),f=(Oe=this.core.get(w).getGptSlot(t))==null?void 0:Oe.getHtml(),A=f!=null,M=(Ue=f==null?void 0:f.length)!=null?Ue:0,q=f==null?void 0:f.substring(0,Math.min(M,100)),_=!d&&m&&!h&&f!=null,B=Date.now(),J=_?this._detectCustomAdFormatInHtml(f):void 0,jt=Date.now()-B,Z=_?this._detectCustomAdFormatInHtmlWithRegEx(f):void 0,lt=Date.now()-B-jt,yt=yield this._waitForIFrameReadyState(r,i),yr=Date.now()-B,Ot=_?this._detectCustomAdFormatInDom(u):void 0;this.core.get(P).fireEvent(Ao,{cd120:yt,cd121:e==null?void 0:e.creativeId,cd122:q,cd130:J==null?void 0:J.adFormat.toLowerCase(),cd131:Ot==null?void 0:Ot.adFormat.toLowerCase(),cd132:Z==null?void 0:Z.adFormat.toLowerCase(),cm120:yr,cm121:d?1:0,cm122:m?1:0,cm123:h?1:0,cm124:A?1:0,cm125:M,cm130:J==null?void 0:J.errorCode,cm131:Ot==null?void 0:Ot.errorCode,cm132:_?1:0,cm133:jt,cm134:lt})})}};o(pt,"IframeReadyState"),s([p(v,"adRendered")],pt.prototype,"_onAdRendered",1),pt=s([g],pt);var ft=class{constructor(){a(this,"initialized",!1);a(this,"size",0)}_initialize(){return S(this,null,function*(){if(yield Promise.resolve(),this.initialized)return;this.initialized=!0,this.core.dvtag.cmd instanceof Array||(this.core.dvtag.cmd=[]);let t=this.core.dvtag.cmd;this.core.dvtag.cmd={push:o((...e)=>{for(let r of e)try{r()}catch(i){}return this.size+=e.length,this.size},"push")},this.core.dvtag.cmd.push(...t)})}};o(ft,"CommandBuffer"),s([D],ft.prototype,"_initialize",1),ft=s([g],ft);var Ft=class{};o(Ft,"HouseHold"),Ft=s([g,N(E),N(ft),N(P),N(dt),N(X),N(pt)],Ft);if(window.dvtag==null||window.dvtag._core==null)try{new kt(pe,window)}catch(n){}})();
